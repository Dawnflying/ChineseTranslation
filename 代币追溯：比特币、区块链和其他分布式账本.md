
区块链网络建立在P2P网络理念的基础上，它提供了一个每个行动者都可以信任的通用数据集，即使他们彼此之间可能不认识或者并不信任对方。数据不可篡改的副本在网络的每个节点上被存储和管理。原生网络代币形式经济激励措施的应用使得网络具有容错性、抗攻击性和抗合谋性。


"区块链"这个概念是在2008年10月发布的比特币白皮书中提出的，目的是创造 "不需要银行的P2P货币"。这篇以中本聪为笔名发表的论文提出了一个系统，在这个系统中，网络中的所有计算机都持有一份相同的交易账本，来作为网络中每个人的单一参考点。所有网络节点共同更新和管理这个账本，它代表了一个每个行动者都可以信任的通用数据集，即使他们可能不认识或者不信任对方。在没有银行、互联网平台或其他类型的清算机构等可信的第三方的前提下，人和机构就算彼此不认识或不信任、处在在不同国家、受不同司法管辖、彼此之间没有协议进行法律约束，现在也可以通过互联网进行互动。

双花问题：这种新的分布式数据管理形式解决了互联网上的双花问题。当今互联网的设计方式，让一个人可以多次消费以数字文件的形式发行的同样的价值，因为数字信息可以被复制，而且同一数字文件的副本可以同时从一台计算机发送到其他多台计算机。在比特币出现之前，围绕着密码学安全的P2P网络的想法已经在不同的演进阶段被讨论过，大多数是在1980年代以来的理论论文中（阅读更多：Annex - Origins of Bitcoin）。然而，从来没有一个P2P网络在不需要可信的中间人保证价值交换的前提下，避免了双花问题。比特币协议引入了一种机制，使复制数字价值的代价变得很高昂。

区块链：在区块链网络中，代币交易被记录在被称为 "区块 "的批量数据中，这些数据就是 "哈希"。这种加密哈希创建了区块的数字指纹(阅读更多：第1部分 —— 代币安全：密码学。)每个区块都包括前一个区块的哈希值，从而将一个区块与另一个区块链接成区块链。这个过程保证了所有区块的历史完整性，可以追溯到的第一个区块，也被称为创世区块。如果一个区块中的数据被篡改，该区块和所有后续区块的哈希值就会发生变化，网络中的每个节点都会知道数据被篡改了。这个不断增长的链式区块列表也被称为账本。

这个账本是一个维护着不断增长的交易记录清单的账本，这些记录以加密的方式串联在一起，防止被篡改和修改。 如果有人试图进行操纵，被操纵账本的哈希值将与所有其他节点上的账本副本上记录的哈希值不一致。因此，区块的哈希值可以作为一种防伪保护，用于检查账本上交易的真实性。

分布式账本：分布式的副本存储在加密保护的P2P网络的多个节点上。要改变整个网络中所有账本副本上的数据，网络节点需要就这种改变达成相互协议。分布式账本是一个共享的、可信的、公开的交易账本，每个人都可以检查，但没有一个用户控制它。每个独立的节点都拥有最新版本的账本，其中包含了所有曾经发生过的交易，并且可以验证交易。这个过程被称为 "共识"。这在组织间的设置中特别有用，因为在这种情况下，没有一个机构愿意信任另一个机构对其数据的管理。

代币："代币 "一词只是一个比喻。与比喻可能暗示的不同，代币并不代表从一个设备发送到另一个设备的数字文件。相反，它表现为账本中属于区块链地址的一个条目。只有拥有该地址私钥的人，才能使用作为区块链客户端的钱包软件，访问相应的代币（阅读更多：第一部分 —— 代币安全：密码学、钱包。

图片: https://uploader.shimo.im/f/VRvbEdZCoE1XVhCI.png

与数据是分布式的，但由一个单一实体管理和控制的分布式数据库不同，区块链网络允许分布式控制。不需要中央管理员，互相不信任的不同人和机构也可以共享信息。

就像云端的电子表格：账本也可以被描述为云端的电子表格。想想像 "Google Sheets "这样的云应用，每个人都可以同时访问和编辑一个文件。但是，与 文件集中存储在Google服务器上的"Google Sheets "相比，区块链网络的账本是一个不集中存储的文件。相反，网络中的每个节点都会随时保存同一个文件的相同副本（每次创建新区块时会有短暂的例外情况）。

通用状态：作为整个网络中的通用数据集，网络中的每台计算机都管理着自己相同的账本副本，这保证每个代币只传输一次。因此，账本代表了网络中所有节点都同意的通用状态。它是一个数字化公证员，也是一个可公开核查的时间戳。

比特币交易：当使用比特币网络时，与银行验证金融交易不同的是， 网络中的所有计算机都会检查他们的账本副本是否有效， 并通过多数节点的共识来确认交易。每个用户都具有相同的信任等级。由运行区块链协议的计算机组成的P2P网络不是由单一的受信任的第三方通过其服务器权威地验证交易（单票制），而是通过共识（多票制）验证交易。

	 
图片: https://uploader.shimo.im/f/uxM3RwMdSP79XTIy.png

协议是一套规则和流程，它定义了网络中所有（匿名）节点如何就网络的真实状态达成协议。协议定义了网络中的参与者相互交流的方式：在哪些条件下，从A向B发送代币是有效的；用加密代币验证交易的经济回报；如何引用身份并签署交易；以及谁来决定进行网络升级。

加密经济学：加密技术保证了网络的安全，为所有参与者提供了充分的透明度，同时维护了每个行为者的隐私。它还可以确保过去的交易是真实的。假设所有网络行为者都有可能腐败，博弈论被应用于确保未来的交易将以可信的方式，通过所有网络行动者的多数共识进行。设计共识机制是为了让人们难以操纵账本。

共识："工作证明 "建立在加密经济原则的基础上，是比特币网络使用的 "共识机制"，它引导着未知的匿名网络行动者的集体行动。反向博弈论被用来奖励网络行为者的原生网络代币。在比特币网络中，使用比特币代币。这种奖励机制的设计是为了使欺骗网络在经济上不可行，因为这样做需要大量的计算能力，并考虑到了极端的攻击场景。尽管没有中心化的各方来管理网络活动的真实性，但共识规则的设计使网络具有抗攻击能力。

身份：区块链地址来源于私钥，代表代币所有者的假名数字身份。代币被注明属于公共账本中的某个地址。只有该地址的所有者才能请求将这些代币发送到其他地方。为了向网络的其他参与者证明他们的所有权，代币持有者需要用他们的私钥签署交易。这种形式的身份管理纯粹基于数学函数，允许网络中的其他计算机确认交易的有效性，而不需要知道实际人的身份或他的私钥（阅读更多：第一部分 —— 密码学和以用户为中心的身份）。

会计与治理机器：区块链网络，也可以说是分布式会计机，或者叫做公开透明的超国家治理机。它们为互联网提供了一个治理层。所有的网络参与者都可以平等地且几乎实时地访问相同的数据。交易是集体管理的。它们对所有参与者都是透明的，并且可以追溯到它们的起源。

分布式自治组织（DAO）：账本由自主的网络节点集体管理，这也是为什么它也预示着一种新的组织基础设施形式，通常被称为分布式自治组织（阅读更多：第2部分--DAO的制度经济学与治理；第4部分：目标驱动的代币）。

区块浏览器：由于区块链网络的公开性，每个人都可以在账本上运行大量数据，比如跟踪所有代币交易、网络总哈希率、代币供应量和交易增长等。然而，虽然账本上的所有数据都是公开的，但很少有人拥有在区块链上进行高级数据分析的技能。区块浏览器是第三方应用程序，允许任何人公开搜索特定网络的所有交易，如比特币以及其他共有区块链网络。区块浏览器就像区块链相关数据的专用搜索引擎。然而，这种高透明度也引发了与隐私相关的问题。这些与隐私相关的问题正在通过较新的区块链协议来解决，这些协议使用了更多的隐私保护加密方法。（阅读更多：第三部分 —— 隐私代币）
 
加密经济学，共识和工作量证明（PoW）

拥有一组匿名网络节点的P2P网络所面临的根本挑战是：如何在没有中心化的各方来保护系统安全的情况下处理恶意网络节点。我们必须始终假设会有不良行为者试图破坏任何开放的公共网络。在不受信任的前提下，这样一个分布式网络如何能够就哪些数据是正确，或者哪些过程是真实的达成共识呢？这就是所谓的 "拜占庭将军问题"。一个恶意节点，也被称为拜占庭节点，它可以故意向所有参与共识过程的其他节点发送错误信息。拜占庭故障被认为是分布式网络中最困难的一类故障。可靠的共识机制必须能够抵御DDoS（分布式拒绝服务）攻击、sybil攻击和其他网络攻击。在比特币出现之前，人们认为在P2P网络中，不信任的节点之间不可能达成容错和抗攻击的共识。

在分布式计算的历史上，比特币协议首次引入了 "工作量证明 "（Proof-of-Work）的数学解决方案，使得攻击系统的经济成本与攻击系统的收益不成比例。它促使了一个围绕使用密码学工具进行经济协调博弈的新科学领域的出现，也被称为 "加密经济学"（Cryptoeconomics）。加密经济学可以定义为：研究在不受信任环境中的经济互动，在这种环境中，每个行为者都有可能是腐败的。它是跨学科的，需要深刻理解密码学、经济学和P2P网络，以及网络行为者的动机。公私钥基础设施保证了一个人的代币的抗攻击访问控制。哈希函数允许节点验证在网络上完成的交易。哈希函数和公钥私钥密码学也是被称为工作量证明的经济协调游戏所需要的，用于奖励将真实的交易区块添加到账本中的员工。加密经济机制可以带来一个安全平衡，使网络具有容错性，以及抗攻击和抗合谋性。这使得匿名网络节点可以就所有网络交互的状态达成共识。比特币网络是加密经济学的第一个实用实例。它产生的是 "数学上的信任"，而不是 "法律契约上的信任"。

然而，关于网络行为者如何对经济激励措施作出反应的假设是否有弹性，是安全与否的决定性因素。长期以来，人们怎样对激励措施作出反应一直是经济学的一个研究领域。因此，加密经济学与机制设计有很多共同之处，机制设计是与博弈论相关的经济学领域。博弈论分析战略互动，这被称为博弈。它试图在两个玩家都最大化自己的最佳结果时，理解每个玩家的最佳策略。机制设计定义了理想的结果，并逆向创建一个激励玩家向该理想结果发展的游戏。虽然加密经济学是跨学科的，但它是一门主要在计算机科学界发展的学科。看来，还有很大的空间可以结合各种经济学科以及其他学科的方法（更多内容将在下一章和第四章——目标驱动的代币中介绍）。


	
图片: https://uploader.shimo.im/f/uOCOq2AJ0nIQJ97p.png

"工作量证明"（PoW）是比特币网络和类似的区块链网络中使用的共识机制，以保证通过网络发送的代币交易是有效的。该机制建立在所有网络节点都有可能会有腐败行为的假设之上，最小的共同点是金钱。工作量证明的设计方式是：(i)如果你花钱并遵守规则，就可以赚取网络代币；(ii)由于挖矿需要特殊用途的计算机硬件，并且消耗大量的电力，所以作弊并不划算。

当代币通过网络发送时，网络中的每个节点都可以写入新的条目到账本中。这些节点对交易进行验证，并相互竞争，来解决一个复杂的计算难题。在这个过程中，他们必须收集所有最近的网络交易，包括一些额外的元数据，验证交易，猜测一个伪随机数（"nonce"），并通过加密算法（SHA-256）运行所有数据，以找到新块的哈希值。这意味着他们必须进行计算工作，这就是为什么这个过程被称为 "工作量证明 "的原因。

如果某个节点是网络中第一个找到该哈希值的节点，它就可以将该区块添加到它的账本中，并将新区块的哈希值（包括所有区块数据）广播给网络中的其他节点。其他节点就可以验证哈希值的有效性。如果他们认为这个新添加的交易区块有效，就会将新区块添加到他们的账本副本中。工作量证明的设计方式是，散列值很难找到，而解决方案却很容易被验证为真。通过参与这场寻找哈希值的竞赛，挖矿节点共同确保一个区块中包含的所有交易都是有效的。胜出的节点将获得 "区块奖励"，其形式为新铸造的网络代币（加上潜在的交易费用）。这就是这个过程被称为 "挖矿"的原因。因此，经过验证的区块的哈希值代表了矿工所做的工作。在本书出版时，比特币网络中成功创建区块的奖励是每个区块6.25 BTC。每隔21万个区块，区块奖励会减少50%，大约每四年一次。下一次区块奖励的 "减半 "是在2024年。

找到正确的哈希值需要做一些工作，其形式是计算机的处理时间，这也被称为 "CPU成本函数"。如果作弊的矿工是找到哈希值最快的计算机，那么网络中的其他计算机就不会接受他们的交易区块。因此，作弊的矿工将无法获得区块奖励，即使他们投入了计算力和能量。 这是一种阻止网络攻击的经济措施。因此，一个理性的经济行为者会避免欺骗系统，因为这将带来能源和基础设施投资的沉没成本。通过基础设施和电力成本的后门，网络攻击的成本变得非常高。一次成功的攻击需要大量的计算力、能耗和时间。由于计算强度大，比特币网络也非常耗能。

为了保持10分钟的区块间时间相对恒定，寻找哈希值，进而创建区块的 "难度 "会随着时间调整。根据矿工网络部署的算力函数会定期调整。如果创建区块的时间少于10分钟，难度就会增加。同样，如果创建区块的时间超过10分钟，难度就会降低。难度也会随着竞争程度的增加而增加 —— 验证一个区块的其他计算机的数量。

	

图片: https://uploader.shimo.im/f/GucAcSF9fFpOtqxl.png

网络节点

比特币网络的特点是：1.开源，2.公开，3.无需权限。开源是指任何具有足够能力的人都可以以公开的方式为协议做出贡献。而且，任何人都可以拿到代码，修改代码，创建自己版本的P2P支付网络。"公开 "是指任何人都可以将网络作为支付系统（用户），任何人都可以下载协议和账本并验证交易（完整节点）。"无需权限 "是指任何人都可以下载协议和账本，并向账本写入交易（矿工）。在比特币网络中，有四种类型的节点：全节点、挖矿节点、矿池和轻节点。

全节点管理着比特币网络（账本）的整个历史，并在新交易加入账本时对其进行验证。任何运行这样全节点的人都可以发送和接收比特币代币，并验证交易的完整性，无需依赖任何第三方。验证交易是对比特币挖矿的补充功能。比特币挖矿几乎都是在专门的硬件上完成的，而只验证交易的完整节点配备标准的处理硬件就可以在普通的家用PC上运行。比特币网络的早期，每个人都必须下载完整的账本才能发送交易。如今，钱包软件开发商也提供了轻节点这样的选择（见下文）。

挖矿节点(矿工)争夺创建新区块和向账本添加交易的权利。他们可以 "单独挖矿 "或 "矿池挖矿"。如果他们单独挖矿，他们需要维护自己账本的完整副本。获胜的矿工会因创建新区块而获得比特币代币奖励（区块奖励）。具体奖励机制在协议中规定。除了区块奖励外，矿工还可以赚取交易费。然而，这些交易费并不是协议规定的，可以由矿工在自由市场上提出要求。交易费通常在网络流量大、网络拥堵时增加。

矿池：这些年来，个人矿工逐渐开始合作，形成挖矿节点联盟。在矿池方案中，个人矿工与其他矿工合作，向账本写入新交易并获得区块奖励。矿池运营商维护一个完整的节点，各个矿工贡献他们的CPU（也称为算力）。利用所有个人矿工的累计算力，他们可以提高自己成为最快解决难题的计算机的机会，并将一个区块交易写入账本。然而，最初的比特币白皮书并没有考虑到矿工之间的这种合作形式。经济假设建立在 "简单博弈论 "的基础上，而不是 "协作博弈论"。因此，比特币网络已经成为一个比最初设想的更加中心化的系统。因此有人认为，现实中比特币的共识机制可以说是 "代表的工作量证明"，已经被少数矿池的寡头垄断，这可能并不能反映比特币创造者中本聪的初衷。

轻节点是为了简化智能手机钱包应用的支付验证（simplified payment verification，SPV）而创建的。这就是为什么它们也被称为SPV节点或SPV-clients。与完整节点相反，它们不维护整个账本，只存储所有交易区块的所有头部的副本。它们不能自主验证交易，因为它们无法访问存储在账本上的所有信息。轻节点依赖于网络中其他对等体给出的信息，这些对等体可以访问所有账本数据。

与挖矿节点相比，全节点并没有验证交易的直接经济动机。然而，不运行轻节点而运行全节点有间接的激励。在可能发生协议升级的情况下，运行全节点是投票决定网络应该如何升级的唯一方式。运行全节点的另一个原因是更高的隐私度，因为全节点在自己的设备上维护完整的账本和所有交易数据。这与轻节点的工作方式完全不同。轻节点依靠第三方服务器向网络广播交易，这意味着这些第三方服务的服务器可以获取轻节点的交易历史。

网络攻击

账本上的所有条目都是只读的。一组交易一旦被网络接受，就不能轻易更改或删除。想要更改和删除，所有的区块都必须重新计算，这就需要大多数网络参与者对这种改变达成一致。攻击者需要在大多数网络节点上重做所有后续区块的计算工作。这就需要控制或贿赂大多数网络节点。即使可以在区块创建期间进行这些计算，其成本也会远远高于攻击网络的回报。虽然操纵是可能的，但该机制的设计使其不可行。
	
这些网站提供了关于目前攻击不同区块链网络的所谓 "51%攻击 "成本的实时信息。只要有超过50%的工作是由诚实的矿工投入的，那么工作证明网络就是安全的。当一个人或机构能够控制大部分的算力或计算能力来操纵网络时，就会发生 "51%攻击"。在比特币的十年历史中，没有任何外部攻击者的操纵成功。

检查攻击比特币网络成本的在线工具。

https://gobitcoin.io/tools/cost-51-attack/

检查攻击不同区块链网络成本的在线工具。

 https://www.crypto51.app/

成功的51%攻击可能会产生以下影响。它可以让你：1.通过添加或删除交易来改变区块，这需要额外的PoW(交易越旧，攻击越难)；2.审查参与者，从而审查这些参与者的交易；3.发送交易，然后逆转交易；4.改变协议规则。

51%攻击不能做的是改变现有的交易或伪造交易，比如：1.改变现有交易中发送的金额；2.改变现有交易的收件人；3.未经某人批准就发送他的代币。这是因为所有的交易都需要用代币拥有者的私钥来签署，而私钥是不能通过网络的多数人同意来透露的。改变现有交易中的一个细节会使账本变得 "不合法"，因为其中没有有效签名的交易会。这些类型的操纵只能通过暴力获取网络行为者的私钥来实现。另外，人们也可以通过破坏加密算法（SHA）来攻击网络，这就是为什么必须使用经过适当压力测试的加密算法的原因（阅读更多内容：第1部分--代币安全：密码学）。

图片: https://uploader.shimo.im/f/jNlggcBrSPtvy4gd.png

协议分叉及网络分叉

在软件工程领域，"软件分叉 "指的是，任何自由和开源软件都可以在不违反版权法的前提下，不经原开发团队的事先许可而进行复制和修改。这个术语有时也不仅仅指代码指，也指现有项目的开发者社区的分叉。公有区块链网络的开源性质允许任何人下载代码，修改代码，并创建一个基于某段代码的独立网络。

这样一来，人们可以：1.通过简单复制现有的代码库，并对其进行修改，从零开始创建一个新的网络（例如 "Zcash "和 "Litecoin "就是基于比特币代码库）2.为了协议更新，将现有的网络（包括现有的账本和社区）分叉成不同的延续。这些协议更新可能会因为协议升级纠纷而导致网络分叉（如 "比特币现金 "和 "以太坊经典 "的情况），也可能是出于经济原因而故意分离，其目的往往是为了在任何哲学协议讨论之上提取经济价值（如 "比特币黄金"、"比特币钻石 "和 "比特币铂金 "的情况）。软件分叉的类型和规则取决于每个网络的正式和非正式协议。比特币网络及类似的网络有 "硬分叉 "和 "软分叉 "之分："

“硬分叉”是一种不向下兼容的协议变更。不更新到新版本协议的节点将无法处理交易。所有根据旧协议验证交易的节点都会将视根据新协议产生的区块为无效。因此，想要采用新协议的节点将需要升级其软件。 

“软分叉”是一种向下兼容的协议变更。没有更新协议的节点如果不违反新的协议规则，仍然能够处理交易。运行升级协议的矿工产生的区块会被网络中的所有节点接受。运行旧版本的矿工产生的区块会被运行新版本协议的节点拒绝。如果旧版本矿工的区块被部分网络拒绝，他们可能也会倾向于升级。因此，软分叉的投票过程比硬分叉更循序渐进一些，需要几周时间。如果大多数矿工升级到新协议，则被称为矿工激活的软分叉（MASF）。如果全节点协调，没有矿工的支持，则称为用户激活的软分叉（UASF）。

当网络中的一些节点继续使用旧协议，而其他节点使用新协议时，就会发生分叉。技术协议更新的频率相当高，通常不会引起太大的争议，尤其是当它们涉及到很小的技术升级时。比较短的链失效，代币变得没有市场价值。然而，区块链网络的短暂历史表明，更政治化的协议升级决定会导致网络的分叉，少数链有足够的追随者或执政理念来维持自己的经济。这其中的一个关键方面是支持一个网络或另一个网络的开发者的思考力分叉。随着社区的分叉，开发者往往不得不为一个网络或另一个网络表态，这可能导致缺乏必要的开发者力量。矿工们也不得不选择继续支持哪个网络（阅读更多：第二部分--DAO的制度经济学与治理。）。

在硬分叉的情况下，任何在旧网络中拥有代币的人也将在新的少数派网络中拥有同等数量的代币，然后他们可以出售或持有这些代币。不过，这至少需要一个代币交易所将少数派网络的新代币上市，否则，该网络的代币就没有市场，结果就是这个网络会逐渐被遗忘。政治化的硬分叉是一个黑天鹅事件，可能会对自己的代币价值产生严重影响，这取决于哪个网络将在长期内发展更佳。政治化硬分叉分叉网络的例子是 "以太坊经典"（ETC）和 "比特币现金"（BCH）。由于这些比特币网络和以太坊网络的著名分叉，治理问题在社区中引发了持续的争论，似乎也是未来几年比较值得关注的研究问题之一（阅读更多：第二部分——DAO的制度经济学与链上与链下治理）。)

此外，由于网络延迟的原因，网络中的时间性分叉也会意外发生。如果两个矿工在同一时间为同一区块找到了不同的解决方案，并且都是有效的，那么网络就有可能暂时分叉。当这种情况发生时，网络中的节点在网络的不同部分拥有两个替代版本的账本。这就形成了两个平行的区块链网络。比特币协议有一个规定来解决这些暂时性分叉，从而使网络中只有一个分支存活下来。在像比特币这样的工作量证明的网络中，拥有最多 "累积工作量证明 "的网络，也叫做 "算力 "或 "网络算力"，总是被网络节点认为是有效的网络。在这个过程中，获胜的账本版本由网络的多数 "投票 "决定。节点通过升级协议（或不升级）来投票支持一个版本："区块链的长度 "指的是累计工作量证明最多的网络分支，而不是区块最多的分支。



